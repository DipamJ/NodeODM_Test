<!DOCTYPE html>
<html>
	<head>
		<title>Project list</title>
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="Resources/style.css">
		<script src="Resources/JS/jquery.min.js"></script>
		
		<link rel="stylesheet" href="Resources/JS/Leaflet/leaflet.css" />
		<script src="Resources/JS/Leaflet/leaflet.js"></script>
		<link rel="stylesheet" type="text/css" href="Resources/JS/JqueryUI/jquery-ui.css">
		<script src="Resources/JS/JqueryUI/jquery-ui.min.js"></script>
		<script src="Resources/JS/MarkerCluster/leaflet.markercluster.js"></script>
		<link rel="stylesheet" type="text/css" href="Resources/JS/MarkerCluster/MarkerCluster.css">
		<link rel="stylesheet" type="text/css" href="Resources/JS/MarkerCluster/MarkerCluster.Default.css">
		
		<script src="Resources/JS/main.js"></script>
		
		<script>
			$(document).ready(function(){
				//map.addLayer(projectMarkers);
				map.addLayer(markers);
				
				projectMarkers.on('clustermouseover', function (e) {
					ShowClusterPopup(e.originalEvent);
				});
				
				projectMarkers.on('clustermouseout', function (e) {
					$("#cluster-popup").hide();
					isClusterPopupShow = false;
					
				});
				
				projectMarkers.on('clusterclick', function (e) {
					$("#cluster-popup").hide();
					isClusterPopupShow = false;
					
				});
				
				
				GetProjectList();
				
				/*
				map.addLayer(pointcloudMarkers);
				
				pointcloudMarkers.on('clustermouseover', function (e) {
					ShowClusterPopup(e.originalEvent);
				});
				
				pointcloudMarkers.on('clustermouseout', function (e) {
					$("#cluster-popup").hide();
					isClusterPopupShow = false;
					
				});
				
				pointcloudMarkers.on('clusterclick', function (e) {
					$("#cluster-popup").hide();
					isClusterPopupShow = false;
					
				});
				
				*/
				GetPointcloudList();
				
				$("#project-search").on('keyup',function () {
					$("#project-list li").each(function(){
						var filter = $("#project-search").val().toUpperCase();
						if ($(this).text().toUpperCase().indexOf(filter) > -1) {
							$(this).show();
						} else {
							$(this).hide();
						}
					});
					
				});
				
				$("#pointcloud-search").on('keyup',function () {
					$("#pointcloud-list li").each(function(){
						var filter = $("#pointcloud-search").val().toUpperCase();
						if ($(this).text().toUpperCase().indexOf(filter) > -1) {
							$(this).show();
						} else {
							$(this).hide();
						}
					});
					
				});
				
			});	
			
			
		</script>
		
	</head>
	<body>
		<div id="cluster-popup" class="cluster-popup">Click to expand</div>
		
			
		<div id="map-control">
			
			<fieldset>
				<legend>Project List</legend>
				<input type="text" id="project-search" class="search">
				<ul id="project-list" >
				</ul>
				
			</fieldset>
			<div style="clear:both; margin: 20px 0"></div>
			<fieldset>
				<legend>Pointcloud List</legend>
				<input type="text" id="pointcloud-search" class="search">
				<ul id="pointcloud-list" >
				</ul>
				
			</fieldset>
		</div>
		<div id="map"></div>
		
		<script>
			var map = L.map('map', {
				center: [30.0122883, -98.6618257],
				zoom: 6,
				minZoom: 3,
				maxZoom: 25,
			});

			var osm_map = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
				attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
				zIndex: 0
			});
		
			map.setMaxBounds([[84.67351256610522, -174.0234375], [-58.995311187950925, 223.2421875]]);
			
			var mapbox = L.tileLayer('https://api.mapbox.com/styles/v1/longhuynh/cjehig4jl6ucb2rozj2oy5lfr/tiles/256/{z}/{x}/{y}?access_token={accessToken}', {
				accessToken: 'pk.eyJ1IjoibG9uZ2h1eW5oIiwiYSI6ImNpbDQ1cmR2bDN2ODB1eW0zeG13MWxxaDgifQ.RMNGP_0kdYujZnz4bLoMUg',
				maxNativeZoom: 19,
				zIndex: 0
			});
			
			
			map.addLayer(mapbox);
			
		</script>
	
	</body>
</html>
